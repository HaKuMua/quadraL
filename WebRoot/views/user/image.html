<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>编辑个人信息</title>
		<script src="../../js/comment.js"></script>
		<link rel="stylesheet" type="text/css" href="../../layui/css/layui.css">
		<script src="../../js/jquery.min.js"></script>
		<script src="../../layui/layui.js"></script>
		<style type="text/css">
			#navId li a {
				font-size: 15px;
				color: white;
				font-weight: bold;
			}

			#rightNav {
				float: right;
			}

			#leftDiv {
				margin-top: 90px;
				position: absolute;
				width: 250px;
				height: 300px;
				margin-left: 350px;
				text-align: center;
			}

			#main {
				margin-top: 90px;
				width: 700px;
				margin-left: 700px;
			}

			.foot {
				margin-top: 150px;
				width: 1090px;
				margin-left: 550px;
			}
		</style>
	</head>
	<body>
		<div id="top">
			<ul class="layui-nav layui-bg-green" id="navId">
				<li class="layui-nav-item">
					<a href="index.html">
						<img src="../../img/logo.jpg" class="layui-nav-img">
					</a>
				</li>
				<li class="layui-nav-item ">
					<form class="layui-form" action="">
						<input id="topSearch" style="  width: 400px;height:48px; font-weight: bold; font-size: 20px; " name="search"
						 placeholder="搜一搜" autocomplete="off" class="layui-input">
					</form>
				</li>
				<div id="rightNav">
					<li class="layui-nav-item"><a href="">故事</a></li>
					<li class="layui-nav-item" style="cursor: pointer;"><a class="NavA" data-method="login">注册</a></li>
					<li class="layui-nav-item" style="cursor: pointer;"><a class="NavA" data-method="login">登录</a></li>
				</div>
			</ul>
		</div>
		<div id="leftDiv">
			<br><br><a href="modifyInfo.html">
				<h2>编辑个人资料</h2>
			</a><br><br>
			<a href="findPwd.html">
				<h2>安全</h2>
			</a><br><br>
			<a href="image.html"><b>
					<h2>照片
				</b></h2></a><br><br>
			<a href="comment.html">
				<h2>我的评论</h2>
			</a><br><br>
			<a href="" class="layui-btn layui-btn-primary">查看我的个人资料</a>
		</div>
		<div id="main">
			<div style="border: 1px solid grey; height: 300px;">
				<div id="" style="height: 40px;background-color: #F2F4F5; line-height: 40px;">
					<h3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;个人头像</h3>
				</div><br><br>
				<div class="layui-col-xs4" >
					<img  id="myImg" src=""  width="180px" height="180px" style="border-radius: 50%;margin-left:20px;">
				</div>
				<div class="layui-col-xs8">
					<h3>提供显示您正脸的个人头像，可以让其他房东/体验达人和房客/参与者对您有个大致印象。<br> 爱彼迎要求所有房东/体验达人提供个人头像。
						<br>爱彼迎不要求房客/参与者提供个人头像，但房东/体验达人可以提出这一要求。<br>
						如果您是房客/参与者，房东/体验达人即便要求您提供个人头像，也只会在您的预订确认之后才能看到。</h3>
					<br><br>
					<button id="submit" type="button" class="layui-btn layui-btn-primary " style="width: 380px; "> <i class="layui-icon">&#xe67c;</i>从您的计算机上传照片</button>
				</div>
			</div><br>
		</div>
		<div class="foot">
			<div>
				<div>京ICP备16017121号-3 京ICP证 160773号
					<img src="https://z1.muscache.cn/airbnb/static/packages/public_security_bureau_logo.d0289dc0.png" alt="中国公安局标志">
					<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010502032345" target="_blank" rel="noopener noreferrer"
					 aria-busy="false">京公网安备 11010502032345号</a>
					技术支持：卓应教育（湖南）有限公司 <a href="https://a0.muscache.com/pictures/03ec62da-f467-4e2b-bfee-6eefd052d7f5.jpg" target="_blank"
					 rel="noopener noreferrer" aria-busy="false">营业执照</a></div>
				<div dir="ltr">© 2019 Airbnb, Inc. All rights reserved.</div>
			</div>
			<br><br><br><br><br><br>
		</div>
	</body>
	<script type="text/javascript">
		//利用Cookie拿到信息
		// var userInfo=$.Cookie('userInfo');
		var userInfo = {
			user_id: '1000',
			user_name: 'haku',
			user_headimg_url: '../../img/timg.jpg',
			user_email: '',
			user_IDcard: '',
			user_pwd: '',
			money: '',
			user_phone: '',
			real_name: '',
			islanlord: 1
		};
		window.onload = function() {
			json = getCookie('userInfo');
			if (json != '' || json == null) {
				jsonInfo = JSON.parse(json);
				if (jsonInfo != null) {
					userInfo = jsonInfo;
				}
			}
			
			$('#myImg').attr('src', userInfo.user_headimg_url);
			//初始化导航栏
			if (userInfo.user_id != '') {
				var html = '<li class="layui-nav-item " id="china"> <a href="" >房源订单中心</a></li>' +
					'<li class="layui-nav-item"><a href="">故事</a></li>' +
					'<li class="layui-nav-item"><a href="">帮助</a> </li>' +
					' <li class="layui-nav-item" lay-unselect=""><a href="javascript:;"><img src="' +
					userInfo.user_img + '" class="layui-nav-img">' + userInfo.user_name + '</a> ' +
					'<dl class="layui-nav-child"><dd><a href="javascript:;"  style="color: gray;">个人中心</a></dd>' +
					' <dd><a href="javascript:;" style="color: gray;">修改信息</a></dd><dd><a href="javascript:;" style="color: gray;">退了</a></dd></dl>';
				$("#rightNav").empty();
				$("#rightNav").append(html);
				if (userInfo.islanlord != 0 || userInfo.islanlord != null) {
					$("#china").after('<li class="layui-nav-item "> <a href="">查看我的房源</a></li>' +
						'<li class="layui-nav-item "><a href="host/create_a_room/room.html">添加房源</a></li>');
				} else {
					$("#china").after('<li class="layui-nav-item "> <a href="">成为房东</a></li>');
				}
			}
		}
		//设置cookie
		function setCookie(cname, cvalue, exdays) {
			var d = new Date();
			d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
			var expires = "expires=" + d.toUTCString();
			document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
		}

		//获取Cookie
		function getCookie(cname) {
			var name = cname + "=";
			var decodedCookie = decodeURIComponent(document.cookie);
			var ca = decodedCookie.split(';');
			for (var i = 0; i < ca.length; i++) {
				var c = ca[i];
				while (c.charAt(0) == ' ') {
					c = c.substring(1);
				}
				if (c.indexOf(name) == 0) {
					return c.substring(name.length, c.length);
				}
			}
			return "";
		}
		
		// $("#submit").on("click", function() {
		// 	user_name = $("#user_name").val();
		// 	user_email = $("#emailDiv").val();
		// 	user_describe = $("#user_area").val();
		// 	if (user_name == '' || user_email == '' || user_describe == '') {
		// 		layer.msg("必填项不能为空！")
		// 	} else {
		// 		map = '{"user_name":' + user_name + ',"user_email":' + user_email + ',"user_describe":' + user_describe + '}'
		// 		$.getJSON(basePath + "user.do?method=updateBasicInfo&callback=?", {
		// 			"map": map
		// 		}, function(result) {
		// 			userInfo = result.userInfo;
		// 			console.log(result)
		// 			if (userInfo != null) {
		// 				layer.msg(result.msg);
		// 				objString = JSON.stringify(userInfo);
		// 				setCookie("userInfo", objString, 1);
		// 				window.setTimeout(function() {
		// 					layer.close(layer.index);
		// 					parent.location.reload();
		// 				}, 1200);
		// 				json = getCookie("userInfo");
		// 				console.log(json)
		// 				jsonInfo = JSON.parse(json);
		// 				console.log(jsonInfo)
		// 			} else {
		// 				layer.msg("保存失败！");
		// 			}
		// 		});
		// 	}
		// });
	</script>
	<script>
		layui.use(['form', 'element', 'layer', 'laypage', 'upload'], function() {
			var form = layui.form,
				$ = layui.jquery,
				layer = layui.layer,
				element = layui.element,
				upload = layui.upload;

			// //多图片上传
			// upload.render({
			// 	elem: '#submit',
			// 	url: '/upload/',
			// 	multiple: true,
			// 	before: function(obj) {
			// 		//预读本地文件示例，不支持ie8
			// 		obj.preview(function(index, file, result) {
			// 			$('#demo2').append('<img src="' + result + '" alt="' + file.name + '" class="layui-upload-img">')
			// 		});
			// 	},
			// 	done: function(res) {
			// 		//上传完毕
			// 	}
			// });
			//普通图片上传
			var uploadInst = upload.render({
				elem: '#submit',
				url: basePath+'user.do?method=uploadImg&user_id=3',
				headers: {"withCredentials": 'true'},
				before: function(obj) {
					//预读本地文件示例，不支持ie8
					obj.preview(function(index, file, result) {
						$('#myImg').attr('src', result); //图片链接（base64）
					});
				},
				done: function(res) {
					//如果上传失败
					console.log(res.data.userInfo);
					if (res.code > 0) {
						return layer.msg('修改失败');
					}else{
						return layer.msg('修改成功');
					}
				},
				error: function() {
					//演示失败状态，并实现重传
					var demoText = $('#demoText');
					demoText.html(
						'<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
					demoText.find('.demo-reload').on('click', function() {
						uploadInst.upload();
					});
				}
			});

		});
	</script>
</html>
