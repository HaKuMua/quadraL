<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>预订您的行程</title>
		<script src="../../js/jquery.min.js"></script>
		<link rel="stylesheet" type="text/css" href="../../layui/css/layui.css">
		<script src="../../js/jquery.min.js"></script>
		<script type="text/javascript" src="../../js/jquery.cookie.js"></script>
		<script src="../../layui/layui.js"></script>
		<style type="text/css">
			#warpper{
				margin-top: 50px;
				margin-left: 450px;
				width: 600px;
			}
			#tip{
				width: 600px;
				height: 70px;
				margin-top: 30px;
				border:1px solid #000000;
			}
			#checkIn{
				margin-top: 30px;
			}
			
			#personNum{
				text-align: center;
				font-size: 25px; 
				width: 150px;
				height: 60px; 
				border: 1px solid grey;
				line-height: 60px;
			}
			
			#rightNav{
				position: relative;
				margin-left: 1150px;
				margin-top: 40px;
				
			}
			#house{
				position: absolute;
				width: 350px;
				height: 450px;
				border:1px solid #000000;
			}
			#notice{
				position: absolute;
				margin-top: 490px;
				width: 350px;
				border:1px solid #000000;
			}
			#sec{
				position: absolute;
				margin-top: 720px;
				width: 350px;
				height: 130px;
				border:1px solid #000000;
			}
			#sec1{
				position: absolute;
				margin-top: 880px;
				width: 350px;
				height: 120px;
				border:1px solid #000000;
			}
			#sec2{
				position: absolute;
				margin-top: 1030px;
				width: 350px;
				height: 120px;
				border:1px solid #000000;
			}
			#house div,#notice div,#sec div,#sec1 div,#sec2 div{
				margin-left: 20px;
			}
			.foot {
				margin-top:500px;
				width: 1090px;
				margin-left: 550px;
			}
		</style>
	</head>
	<body>
		<div style=" line-height:40px;z-index: 100; width: 100%;height: 60px; background-color: #EBEBEB;">
				<a href="../index.html" >
					<img src="../../img/logo.jpg" class="layui-nav-img"  style="margin-top:10px;">
				</a>
				<h3 style="position: absolute; margin-top: -30px; margin-left: 60px;"><b>1 预订您的行程</b> &nbsp;2 确认并支付</h3>
		</div>	
		<div id="rightNav">
			<div id="house">
					<br><div class="layui-col-xs7">
						<h2><b>藝净- 复古花,太古里旁高层花园电影套房</b></h2><br>
						<h3>成都的整套公寓</h3>
					</div>
					<div class="layui-col-xs3">
						<img src="../../img/room/997b02ab-9522-4500-a0de-6e67a94bbe9b.jpg" width="100px" >
					</div>
					<hr ><br>
					<div >
					<h2>地址：中国衡阳</h2><br>
					<h2>人数：1人</h2><br>
					<h2>时间：2019年12月7日 - 2019年12月8日</h2>
					<hr ><br><br>
					</div>
					<div class="layui-col-xs6">
						<h2>￥558.00 x1晚</h2>
					</div>
					<div class="layui-col-xs3">
						<h2>￥558.00</h2>
					</div>
					<hr ><br>
					<div class="layui-col-xs6">
						<h2><b>总价	</b></h2>
					</div>
					<div class="layui-col-xs3">
						<h2>￥1110.00</h2>
					</div>
			</div>
			<div id="notice">
				<br><h2 style="margin-left: 20px;"><b>入住须知</b></h2><br>
				<div >
					<h2>不允许携带宠物</h2><br>
					<h2>不允许举办派对和活动</h2><br>
					<h2>14:00后可以随时入住</h2><br>
					<h2>12:00前退房</h2>
				</div>
			</div>
			<div id="sec">
				<br>
				<div class="layui-col-xs5">
					<h2><b>爱彼迎旅行保障</b></h2>
					<h4>房源保障 · 中文客服 · 安全保障</h4>
				</div>
				<div class="<layui-col-xs5></layui-col-xs5>">
					<img src="../../img/tag/3.svg" width="100px" >
				</div>
			</div>
			<div id="sec1">
				<br><br>
				<div class="layui-col-xs12">
					<h2><b>安全须知</b></h2>
					<h3>该房源未安装一氧化碳报警器</h3>
				</div>
			</div>
			<div id="sec2">
				<br>
				<div class="layui-col-xs12">
					<h2><b>发票</b></h2>
					<h4>若需要开具房费发票，请您与房东协商</h4>
				</div>
			</div>
		</div>
		<div id="warpper">
			<span style="font-weight: bolder; font-size: 35px; color: gray;">
				预订您的行程
			</span><br><br>
			<div id="tip">
				<div class="layui-col-xs2">
					<img src="../../img/tag/6.gif"  height="70px">
				</div><br><br>
				<div id="landlord_name" class="layui-col-xs10">
					<h2>这是一个抢手房源。藝的房源通常很抢手。</h2>
				</div>	
			</div><br><br><br>	
			<div >
				<h2><b>预订中国房源</b></h2><br>
				<h3>根据有关部门规定，所有在中国预定住宿的旅客都必须提供以下信息。
					作为中国居民，您的信息将由爱彼迎中国存储并处理。完成本次预订，您同意爱彼迎中国向中国政府披露您的信息而不向您提供进一步通知
				<br><br>您所填的信息将不会与房东分享。房客信息将由爱彼迎中国妥善保管，以便下次预订时使用。</h3>
			</div>
			<div id="checkIn">
				<h2><b>房客人数</b></h2><br>
				<div id="personNum" >
					2人
				</div>
				<br><br>
				<h2><b>房客信息</b></h2><br>
				<br><br>
				<div id="personInfo">
					<div class="layui-col-xs4">
						<h3><b>姓名</b></h3>
					</div>
					<div class="layui-col-xs8">
						<h3><b>身份证件号码</b></h3>
					</div><br><br>
					<div class="layui-col-xs4">
						<input  style=" width: 150px;height:60px; font-weight: bold; font-size: 20px; " name="search"
						 autocomplete="off" class="layui-input">
					</div>
					<div class="layui-col-xs8">
						<input  style=" width: 400px;height:60px; font-weight: bold; font-size: 20px; " name="search"
						 autocomplete="off" class="layui-input">
					</div><br><br><br><br><br>
				</div>
			</div>
			<button type="button" class="layui-btn layui-bg-red layui-btn-radius"  id="go"
			style= " margin-top:50px; width: 110px;height: 50px; font-size: 20px;" >继续</button>
		</div>
		<div class="foot" >
			<div >
				<div>京ICP备16017121号-3 京ICP证 160773号 
				<img src="https://z1.muscache.cn/airbnb/static/packages/public_security_bureau_logo.d0289dc0.png"
					 alt="中国公安局标志"> <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010502032345" target="_blank"
					 rel="noopener noreferrer"  aria-busy="false">京公网安备 11010502032345号</a>
					技术支持：卓应教育（湖南）有限公司 <a href="https://a0.muscache.com/pictures/03ec62da-f467-4e2b-bfee-6eefd052d7f5.jpg" target="_blank"
					 rel="noopener noreferrer"  aria-busy="false">营业执照</a></div>
				<div dir="ltr" >© 2019 Airbnb, Inc. All rights reserved.</div>
			</div>
			<br><br><br><br><br><br>
		</div>
	</body>
	<script>
		layui.use(['form', 'layedit','laydate'], function(){
			var form = layui.form
			,layer = layui.layer
			form.on('checkbox()', function(data){
				if(data.elem.checked) {
					mySpace.push(data.value);
				} else {
					mySpace.pop(data.value);
				}
				console.log(data.elem.checked); //是否被选中，true或者false
				console.log(data.value); //复选框value值，也可以通过data.elem.value得到
			});
		});
	</script>
	<script>
		window.onload = function() {
			myCookie=getCookie('orderInfo')
			orderInfo = JSON.parse(myCookie);
			console.log(orderInfo)
			getInfo(orderInfo)
			info=getCookie('personInfo');
			// if(info != '') {
			// 	personInfo = JSON.parse(info);
			// 	for(let i=0;i<orderInfo.house_intake;i++) {
			// 		$("#name"+i).val(personInfo[i].name);
			// 		$("#idCard"+i).val(personInfo[i].idCard);
			// 	}
			// }
			
			var reg =/(^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$)|(^[1-9]\d{5}\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}$)/;
			personInfo=[]
			$("#go").on("click",function() {
				for(let i=0;i<orderInfo.house_intake;i++) {
					name = $("#name"+i).val();
					idCard = $("#idCard"+i).val();
					if(name == null || idCard == null ||name == '' ||idCard == '' ) {
						layer.msg("请填写完整！");
						return false;
					}
					if(!reg.test(idCard)) {
						layer.msg("请输入正确的身份证号码!");
						return false;
					}
				}
				for(let i=0;i<orderInfo.house_intake;i++) {
					name = $("#name"+i).val();
					idCard = $("#idCard"+i).val();
					info={'name':name,'idCard':idCard};
					personInfo.push(info);
				}
				var objString = JSON.stringify(personInfo);
				setCookie("personInfo", objString, 1);
				location.href="pay.html";
			})
		}
		
		//设置cookie
		function setCookie(cname, cvalue, exdays) {
		    var d = new Date();
		    d.setTime(d.getTime() + (exdays*24*60*60*1000));
		    var expires = "expires="+ d.toUTCString();
		    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
		} 
		//获取Cookie
		function getCookie(cname) {
		    var name = cname + "=";
		    var decodedCookie = decodeURIComponent(document.cookie);
		    var ca = decodedCookie.split(';');
		    for(var i = 0; i <ca.length; i++) {
		        var c = ca[i];
		        while (c.charAt(0) == ' ') {
		            c = c.substring(1);
		         }
		         if (c.indexOf(name) == 0) {
		            return c.substring(name.length, c.length);
		         }
		     }
		    return "";
		} 
		
		function getInfo(orderInfo) {
			$("#house").empty();
			html='<br><div class="layui-col-xs7"><h2><b>'+orderInfo.house_name+'</b></h2><br><h3>'+orderInfo.house_type+'/'+orderInfo.lease_type+'</h3>'+
				'</div><div class="layui-col-xs3"><img src="'+orderInfo.allHouseImg+'" width="100px" >'+
				'</div><hr ><br><div ><h2>地址：'+orderInfo.house_address+'</h2><br><h2>人数：'+orderInfo.house_intake+'人</h2><br><h2>时间：'+orderInfo.startTime+'--'+orderInfo.endTime+' </h2>'+
				'<hr ><br><br></div><div class="layui-col-xs6"><h2>￥'+orderInfo.house_price+' x'+orderInfo.dayNumber+'晚</h2></div>'+
				'<div class="layui-col-xs3"><h2>￥'+orderInfo.house_price*orderInfo.dayNumber+'</h2></div><hr ><br><div class="layui-col-xs6"><h2><b>总价	</b></h2>'+
				'</div><div class="layui-col-xs3"><h2>￥'+orderInfo.house_price*orderInfo.dayNumber+'</h2></div>';
			$("#house").append(html);
			$("#notice").empty();
			$("#notice").append('<br><h2 style="margin-left: 20px;"><b>入住须知</b></h2><br><div id="t1"></div>');
			for(let i=0;i<orderInfo.building_name.length;i++) {
				html='<h2>'+orderInfo.building_name[i]+'</h2><br>';
				$("#t1").append(html);
			}	
			$("#landlord_name").empty();
			$("#landlord_name").append('<h2>这是一个抢手房源。'+orderInfo.user_name+'的房源通常很抢手。</h2>');
			$("#personNum").empty();
			$("#personNum").append('<span>'+orderInfo.house_intake+'人</span>');
			$("#personInfo").empty();
			for(let i=0;i<orderInfo.house_intake;i++) {
				html='<div  class="layui-col-xs4"><h3><b>姓名</b></h3></div><div class="layui-col-xs8"><h3><b>身份证件号码</b></h3>'+
					'</div><br><br><div class="layui-col-xs4">'+
					'<input id="name'+i+'" style=" width: 150px;height:60px; font-weight: bold; font-size: 20px; " name="search"'+
					'autocomplete="off" class="layui-input">'+
					'</div><div class="layui-col-xs8"><input id="idCard'+i+'"'+
					' style=" width: 400px;height:60px; font-weight: bold; font-size: 20px; " name="search" autocomplete="off" class="layui-input">'+
					'</div><br><br><br><br><br>';
				$("#personInfo").append(html);
			}
		}
		
	</script>
</html>
